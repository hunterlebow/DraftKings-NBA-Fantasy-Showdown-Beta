<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <title>PyKings.io</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar">
      <div class="nav-container">
        <a href="#" class="logo">
          <img
            src="/static/crown-svgrepo-com.svg"
            alt="PyKings.io Logo"
            width="32"
            height="32"
          />
          PyKings.io
        </a>
        <div class="nav-links" id="navLinks">
          <a href="#home" class="nav-link">Home</a>
          <a href="#how-it-works" class="nav-link">How It Works</a>
          <a href="#optimizer" class="nav-link">Optimizer</a>
          <a href="#about" class="nav-link">About</a>
        </div>
        <button class="mobile-menu-btn" id="mobileMenuBtn">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero" id="home">
      <div class="hero-content">
        <h1>PyKings.io</h1>
        <p>
          A linear programming tool for optimizing DraftKings NBA Showdown
          lineups. Built as a portfolio project to demonstrate optimization
          algorithms.
        </p>
        <a href="#optimizer" class="cta-btn">
          <i class="fas fa-magic"></i> Try the Optimizer
        </a>
      </div>
    </section>

    <!-- How It Works Section -->
    <section class="how-it-works" id="how-it-works">
      <div class="container">
        <div class="section-title">
          <h2>How It Works</h2>
          <p>
            This project uses the PuLP library to solve the lineup optimization
            problem through linear programming techniques.
          </p>
        </div>

        <div class="steps">
          <div class="step">
            <div class="step-icon">
              <i class="fas fa-file-upload"></i>
            </div>
            <h3>Upload Your Data</h3>
            <p>
              Upload a spreadsheet with player data including names, projected
              points, and salaries.
            </p>
          </div>

          <div class="step">
            <div class="step-icon">
              <i class="fas fa-cogs"></i>
            </div>
            <h3>Optimization Process</h3>
            <p>
              The algorithm finds lineups that maximize projected points while
              respecting the salary cap constraint.
            </p>
          </div>

          <div class="step">
            <div class="step-icon">
              <i class="fas fa-trophy"></i>
            </div>
            <h3>View Results</h3>
            <p>
              Review multiple optimized lineups with details on projected points
              and salary allocation.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Optimizer Section -->
    <section id="optimizer">
      <div class="container">
        <header>
          <h1>Lineup Optimizer</h1>
          <p class="subtitle">
            A tool to generate optimal DraftKings NBA Showdown lineups using
            linear programming
          </p>
        </header>

        <div class="card upload-section" id="uploadSection">
          <h2>Upload Player Data</h2>
          <form id="uploadForm" enctype="multipart/form-data" method="post">
            <div class="upload-container" id="dropZone">
              <i class="fas fa-cloud-upload-alt upload-icon"></i>
              <p>Drag & drop your file here or</p>
              <input
                type="file"
                id="fileInput"
                name="file"
                class="file-input"
                accept=".csv, .xls, .xlsx"
              />
              <button type="button" class="upload-btn" id="browseBtn">
                <i class="fas fa-file-excel"></i> Browse Files
              </button>
              <div class="file-info" id="fileInfo"></div>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn" disabled>
              <i class="fas fa-magic"></i> Generate Lineups
            </button>
          </form>

          <div class="template-links">
            <a href="/download_template" class="template-link">
              <i class="fas fa-download"></i> Download Template
            </a>
            <a href="/download_example" class="template-link">
              <i class="fas fa-file-alt"></i> Download Example
            </a>
          </div>
        </div>

        <div class="loading" id="loadingSection">
          <div class="spinner"></div>
          <p>Generating optimal lineups...</p>
          <p>This may take a few moments</p>
        </div>

        <div class="error-message" id="errorMessage"></div>

        <div class="results-section" id="resultsSection">
          <div class="results-header">
            <h2>Optimal Lineups</h2>
            <button class="back-btn" id="backBtn">
              <i class="fas fa-arrow-left"></i> Back to Upload
            </button>
          </div>

          <div class="tabs" id="lineupTabs">
            <!-- Tabs will be generated dynamically -->
          </div>

          <div id="lineupResults">
            <!-- Lineup results will be generated dynamically -->
          </div>
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section class="about-section" id="about">
      <div class="container">
        <div class="about-card">
          <h2 class="about-title">About This Project</h2>
          <div class="about-content">
            <div class="about-text">
              <p>
                PyKings.io is a portfolio project created to demonstrate
                practical applications of optimization algorithms and web
                development skills.
              </p>
              <p>
                The project uses PuLP, an open-source linear programming
                library, to solve the lineup optimization problem with these
                constraints:
              </p>
              <ul>
                <li>$50,000 salary cap</li>
                <li>6 players total (1 Captain, 5 Utility players)</li>
                <li>
                  Captain position with 1.5x points multiplier and 1.5x salary
                  cost
                </li>
              </ul>
              <p>
                This tool generates multiple lineup variations to provide
                options for fantasy sports contests.
              </p>
            </div>
            <div class="about-image">
              <svg
                viewBox="0 0 800 600"
                xmlns="http://www.w3.org/2000/svg"
                style="width: 100%; height: auto"
              >
                <defs>
                  <linearGradient
                    id="bgGradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="100%"
                  >
                    <stop offset="0%" stop-color="#1e40af" />
                    <stop offset="100%" stop-color="#3b82f6" />
                  </linearGradient>
                  <linearGradient
                    id="nodeGradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="100%"
                  >
                    <stop offset="0%" stop-color="#10b981" />
                    <stop offset="100%" stop-color="#059669" />
                  </linearGradient>
                  <filter
                    id="glow"
                    x="-20%"
                    y="-20%"
                    width="140%"
                    height="140%"
                  >
                    <feGaussianBlur stdDeviation="8" result="blur" />
                    <feComposite
                      in="SourceGraphic"
                      in2="blur"
                      operator="over"
                    />
                  </filter>
                </defs>

                <!-- Background -->
                <rect
                  x="0"
                  y="0"
                  width="800"
                  height="600"
                  rx="15"
                  fill="url(#bgGradient)"
                  opacity="0.1"
                />

                <!-- Grid lines -->
                <g stroke="#3b82f6" stroke-width="1" opacity="0.2">
                  <g id="vertical-lines">
                    <line x1="100" y1="50" x2="100" y2="550" />
                    <line x1="200" y1="50" x2="200" y2="550" />
                    <line x1="300" y1="50" x2="300" y2="550" />
                    <line x1="400" y1="50" x2="400" y2="550" />
                    <line x1="500" y1="50" x2="500" y2="550" />
                    <line x1="600" y1="50" x2="600" y2="550" />
                    <line x1="700" y1="50" x2="700" y2="550" />
                  </g>
                  <g id="horizontal-lines">
                    <line x1="50" y1="100" x2="750" y2="100" />
                    <line x1="50" y1="200" x2="750" y2="200" />
                    <line x1="50" y1="300" x2="750" y2="300" />
                    <line x1="50" y1="400" x2="750" y2="400" />
                    <line x1="50" y1="500" x2="750" y2="500" />
                  </g>
                </g>

                <!-- Network nodes and connections -->
                <g id="network">
                  <!-- Nodes -->
                  <circle
                    cx="150"
                    cy="150"
                    r="25"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="300"
                    cy="200"
                    r="30"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="450"
                    cy="150"
                    r="20"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="600"
                    cy="200"
                    r="25"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="200"
                    cy="350"
                    r="25"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="400"
                    cy="400"
                    r="35"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="600"
                    cy="350"
                    r="20"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="300"
                    cy="500"
                    r="25"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />
                  <circle
                    cx="500"
                    cy="500"
                    r="30"
                    fill="url(#nodeGradient)"
                    filter="url(#glow)"
                  />

                  <!-- Connections -->
                  <g stroke="#10b981" stroke-width="3" opacity="0.6">
                    <line x1="150" y1="150" x2="300" y2="200" />
                    <line x1="300" y1="200" x2="450" y2="150" />
                    <line x1="450" y1="150" x2="600" y2="200" />
                    <line x1="300" y1="200" x2="200" y2="350" />
                    <line x1="450" y1="150" x2="400" y2="400" />
                    <line x1="600" y1="200" x2="600" y2="350" />
                    <line x1="200" y1="350" x2="300" y2="500" />
                    <line x1="400" y1="400" x2="300" y2="500" />
                    <line x1="400" y1="400" x2="500" y2="500" />
                    <line x1="600" y1="350" x2="500" y2="500" />
                  </g>
                </g>

                <!-- Data points and optimization curve -->
                <g id="optimization">
                  <path
                    d="M100,450 Q250,200 400,250 T700,150"
                    fill="none"
                    stroke="#3b82f6"
                    stroke-width="5"
                    opacity="0.8"
                  />

                  <!-- Data points -->
                  <circle cx="150" cy="400" r="8" fill="#1e40af" />
                  <circle cx="250" cy="300" r="8" fill="#1e40af" />
                  <circle cx="350" cy="250" r="8" fill="#1e40af" />
                  <circle cx="450" cy="280" r="8" fill="#1e40af" />
                  <circle cx="550" cy="200" r="8" fill="#1e40af" />
                  <circle cx="650" cy="150" r="8" fill="#1e40af" />
                </g>

                <!-- Basketball elements -->
                <g id="basketball-elements">
                  <circle
                    cx="700"
                    cy="100"
                    r="40"
                    fill="#ff8800"
                    opacity="0.8"
                  />
                  <g stroke="#333" stroke-width="2">
                    <path d="M670,100 Q700,70 730,100" fill="none" />
                    <path d="M670,100 Q700,130 730,100" fill="none" />
                    <path d="M700,60 Q670,100 700,140" fill="none" />
                    <path d="M700,60 Q730,100 700,140" fill="none" />
                  </g>
                </g>

                <!-- Binary/code elements -->
                <g
                  id="binary"
                  fill="#ffffff"
                  opacity="0.4"
                  font-family="monospace"
                  font-size="12"
                >
                  <text x="100" y="80">10110101</text>
                  <text x="200" y="120">01001010</text>
                  <text x="300" y="80">11100111</text>
                  <text x="500" y="120">10011001</text>
                  <text x="600" y="80">01010101</text>
                  <text x="100" y="520">00111100</text>
                  <text x="400" y="520">11001100</text>
                  <text x="600" y="520">10101010</text>
                </g>

                <!-- Animated elements -->
                <g>
                  <circle cx="400" cy="300" r="5" fill="#ffffff">
                    <animate
                      attributeName="r"
                      values="5;10;5"
                      dur="3s"
                      repeatCount="indefinite"
                    />
                    <animate
                      attributeName="opacity"
                      values="0.3;0.8;0.3"
                      dur="3s"
                      repeatCount="indefinite"
                    />
                  </circle>
                  <circle cx="200" cy="200" r="5" fill="#ffffff">
                    <animate
                      attributeName="r"
                      values="5;8;5"
                      dur="2s"
                      repeatCount="indefinite"
                    />
                    <animate
                      attributeName="opacity"
                      values="0.3;0.7;0.3"
                      dur="2s"
                      repeatCount="indefinite"
                    />
                  </circle>
                  <circle cx="600" cy="400" r="5" fill="#ffffff">
                    <animate
                      attributeName="r"
                      values="5;8;5"
                      dur="4s"
                      repeatCount="indefinite"
                    />
                    <animate
                      attributeName="opacity"
                      values="0.3;0.7;0.3"
                      dur="4s"
                      repeatCount="indefinite"
                    />
                  </circle>
                </g>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-container">
          <div class="footer-section">
            <h3>PyKings.io</h3>
            <p>
              A portfolio project demonstrating optimization algorithms for
              fantasy sports lineups.
            </p>
            <div class="social-links">
              <a
                href="https://github.com/hunterlebow"
                class="social-link"
                target="_blank"
              >
                <i class="fab fa-github"></i>
              </a>
              <a
                href="https://linkedin.com/in/hunterlebow"
                class="social-link"
                target="_blank"
              >
                <i class="fab fa-linkedin"></i>
              </a>
            </div>
          </div>

          <div class="footer-section">
            <h3>Quick Links</h3>
            <div class="footer-links">
              <a href="#home">Home</a>
              <a href="#how-it-works">How It Works</a>
              <a href="#optimizer">Optimizer</a>
              <a href="#about">About</a>
            </div>
          </div>
        </div>

        <div class="disclaimer">
          <p>
            This site is a portfolio project and is not affiliated with,
            endorsed by, or sponsored by DraftKings Inc. All DraftKings
            trademarks and logos are the property of DraftKings Inc.
          </p>
        </div>

        <div class="copyright">
          <p>
            &copy; 2025 PyKings.io. Created by
            <a
              href="https://linkedin.com/in/hunterlebow"
              target="_blank"
              class="creator-link"
              >Hunter Lebow</a
            >
            as a portfolio demonstration project.
          </p>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById("mobileMenuBtn");
        const navLinks = document.getElementById("navLinks");

        mobileMenuBtn.addEventListener("click", function () {
          navLinks.classList.toggle("active");

          // Change icon based on menu state
          const icon = mobileMenuBtn.querySelector("i");
          if (navLinks.classList.contains("active")) {
            icon.classList.remove("fa-bars");
            icon.classList.add("fa-times");
          } else {
            icon.classList.remove("fa-times");
            icon.classList.add("fa-bars");
          }
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();

            // Close mobile menu if open
            navLinks.classList.remove("active");
            mobileMenuBtn.querySelector("i").classList.remove("fa-times");
            mobileMenuBtn.querySelector("i").classList.add("fa-bars");

            const targetId = this.getAttribute("href");
            const targetElement = document.querySelector(targetId);

            if (targetElement) {
              window.scrollTo({
                top: targetElement.offsetTop - 70, // Adjust for navbar height
                behavior: "smooth",
              });
            }
          });
        });

        const uploadForm = document.getElementById("uploadForm");
        const fileInput = document.getElementById("fileInput");
        const browseBtn = document.getElementById("browseBtn");
        const submitBtn = document.getElementById("submitBtn");
        const fileInfo = document.getElementById("fileInfo");
        const dropZone = document.getElementById("dropZone");
        const uploadSection = document.getElementById("uploadSection");
        const loadingSection = document.getElementById("loadingSection");
        const resultsSection = document.getElementById("resultsSection");
        const errorMessage = document.getElementById("errorMessage");
        const backBtn = document.getElementById("backBtn");
        const lineupTabs = document.getElementById("lineupTabs");
        const lineupResults = document.getElementById("lineupResults");

        // Handle file selection
        browseBtn.addEventListener("click", function () {
          fileInput.click();
        });

        fileInput.addEventListener("change", function () {
          if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            fileInfo.textContent = `Selected file: ${file.name}`;
            submitBtn.disabled = false;
          } else {
            fileInfo.textContent = "";
            submitBtn.disabled = true;
          }
        });

        // Handle drag and drop
        dropZone.addEventListener("dragover", function (e) {
          e.preventDefault();
          dropZone.style.borderColor = "var(--primary)";
          dropZone.style.backgroundColor = "rgba(59, 130, 246, 0.1)";
        });

        dropZone.addEventListener("dragleave", function () {
          dropZone.style.borderColor = "var(--gray-light)";
          dropZone.style.backgroundColor = "transparent";
        });

        dropZone.addEventListener("drop", function (e) {
          e.preventDefault();
          dropZone.style.borderColor = "var(--gray-light)";
          dropZone.style.backgroundColor = "transparent";

          if (e.dataTransfer.files.length > 0) {
            fileInput.files = e.dataTransfer.files;
            const file = fileInput.files[0];
            fileInfo.textContent = `Selected file: ${file.name}`;
            submitBtn.disabled = false;
          }
        });

        // Handle form submission
        uploadForm.addEventListener("submit", function (e) {
          e.preventDefault();

          // Show loading
          uploadSection.style.display = "none";
          loadingSection.style.display = "block";
          errorMessage.style.display = "none";

          const formData = new FormData(uploadForm);

          fetch("/", {
            method: "POST",
            body: formData,
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              return response.json();
            })
            .then((data) => {
              // Hide loading
              loadingSection.style.display = "none";

              if (data.Error) {
                // Show error
                errorMessage.textContent = data.Error;
                errorMessage.style.display = "block";
                uploadSection.style.display = "flex";
              } else {
                // Show results
                displayResults(data);
                resultsSection.style.display = "block";
              }
            })
            .catch((error) => {
              // Hide loading and show error
              loadingSection.style.display = "none";
              errorMessage.textContent = "An error occurred. Please try again.";
              errorMessage.style.display = "block";
              uploadSection.style.display = "flex";
              console.error("Error:", error);
            });
        });

        // Handle back button
        backBtn.addEventListener("click", function () {
          resultsSection.style.display = "none";
          uploadSection.style.display = "flex";
          // Reset form
          uploadForm.reset();
          fileInfo.textContent = "";
          submitBtn.disabled = true;
        });

        // Function to display results
        function displayResults(data) {
          // Clear previous results
          lineupTabs.innerHTML = "";
          lineupResults.innerHTML = "";

          const db = data.db;
          const lineupKeys = Object.keys(db).sort(
            (a, b) => parseFloat(b) - parseFloat(a)
          );

          // Create tabs
          lineupKeys.forEach((key, index) => {
            const tab = document.createElement("div");
            tab.className = `tab ${index === 0 ? "active" : ""}`;
            tab.textContent = `Lineup ${index + 1}`;
            tab.dataset.lineup = key;

            tab.addEventListener("click", function () {
              // Remove active class from all tabs
              document
                .querySelectorAll(".tab")
                .forEach((t) => t.classList.remove("active"));
              // Add active class to clicked tab
              tab.classList.add("active");

              // Hide all lineups
              document
                .querySelectorAll(".lineup")
                .forEach((l) => l.classList.remove("active"));
              // Show selected lineup
              document
                .getElementById(`lineup-${key.replace(".", "-")}`)
                .classList.add("active");
            });

            lineupTabs.appendChild(tab);
          });

          // Create lineup results
          lineupKeys.forEach((key, index) => {
            const lineup = db[key];

            // Calculate total points and salary
            let totalPoints = 0;
            let totalSalary = 0;

            lineup.forEach((player) => {
              totalPoints += player["Projected Points"];
              totalSalary += player["Cost"];
            });

            const lineupDiv = document.createElement("div");
            lineupDiv.className = `lineup ${index === 0 ? "active" : ""}`;
            lineupDiv.id = `lineup-${key.replace(".", "-")}`;

            // Lineup header with stats
            const lineupHeader = document.createElement("div");
            lineupHeader.className = "lineup-header";

            const lineupTitle = document.createElement("h3");
            lineupTitle.textContent = `Lineup ${index + 1}`;

            const lineupStats = document.createElement("div");
            lineupStats.className = "lineup-stats";

            // Points stat
            const pointsStat = document.createElement("div");
            pointsStat.className = "stat";

            const pointsValue = document.createElement("div");
            pointsValue.className = "stat-value";
            pointsValue.textContent = totalPoints.toFixed(2);

            const pointsLabel = document.createElement("div");
            pointsLabel.className = "stat-label";
            pointsLabel.textContent = "Projected Points";

            pointsStat.appendChild(pointsValue);
            pointsStat.appendChild(pointsLabel);

            // Salary stat
            const salaryStat = document.createElement("div");
            salaryStat.className = "stat";

            const salaryValue = document.createElement("div");
            salaryValue.className = "stat-value";
            salaryValue.textContent = `$${(totalSalary / 1000).toFixed(1)}K`;

            const salaryLabel = document.createElement("div");
            salaryLabel.className = "stat-label";
            salaryLabel.textContent = "Total Salary";

            salaryStat.appendChild(salaryValue);
            salaryStat.appendChild(salaryLabel);

            // Remaining salary stat
            const remainingStat = document.createElement("div");
            remainingStat.className = "stat";

            const remainingValue = document.createElement("div");
            remainingValue.className = "stat-value";
            remainingValue.textContent = `$${(
              (50000 - totalSalary) /
              1000
            ).toFixed(1)}K`;

            const remainingLabel = document.createElement("div");
            remainingLabel.className = "stat-label";
            remainingLabel.textContent = "Remaining Salary";

            remainingStat.appendChild(remainingValue);
            remainingStat.appendChild(remainingLabel);

            lineupStats.appendChild(pointsStat);
            lineupStats.appendChild(salaryStat);
            lineupStats.appendChild(remainingStat);

            lineupHeader.appendChild(lineupTitle);
            lineupHeader.appendChild(lineupStats);

            // Player table
            const table = document.createElement("table");
            table.className = "player-table";

            // Table header
            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");

            const headers = ["Role", "Player", "Projected Points", "Salary"];

            headers.forEach((header) => {
              const th = document.createElement("th");
              th.textContent = header;
              headerRow.appendChild(th);
            });

            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Table body
            const tbody = document.createElement("tbody");

            lineup.forEach((player) => {
              const row = document.createElement("tr");
              if (player.Status === "Captain") {
                row.className = "captain";
              }

              // Role cell
              const roleCell = document.createElement("td");
              const roleBadge = document.createElement("span");
              roleBadge.className =
                player.Status === "Captain" ? "captain-badge" : "utility-badge";
              roleBadge.textContent = player.Status;
              roleCell.appendChild(roleBadge);

              // Player name cell
              const nameCell = document.createElement("td");
              nameCell.textContent = player.Name;

              // Points cell
              const pointsCell = document.createElement("td");
              pointsCell.textContent = player["Projected Points"].toFixed(2);

              // Salary cell
              const salaryCell = document.createElement("td");
              salaryCell.textContent = `$${player.Cost.toLocaleString()}`;

              row.appendChild(roleCell);
              row.appendChild(nameCell);
              row.appendChild(pointsCell);
              row.appendChild(salaryCell);

              tbody.appendChild(row);
            });

            table.appendChild(tbody);

            lineupDiv.appendChild(lineupHeader);
            lineupDiv.appendChild(table);

            lineupResults.appendChild(lineupDiv);
          });
        }
      });
    </script>
  </body>
</html>
